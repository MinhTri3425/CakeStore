<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
<meta charset="UTF-8">
<title>Quản lý User & Staff</title>
<link rel="stylesheet"
	th:href="@{/webjars/bootstrap/5.3.8/css/bootstrap.min.css}" />
<link rel="stylesheet" th:href="@{/css/style.css}" />
</head>
<body>
	<div th:replace="~{fragments/header :: header}"></div>

	<div class="container-fluid mt-4">
		<div class="row">
			<div th:replace="~{admin/home :: sidebar}"></div>
			<div class="col-md-9">
				<h2 class="mb-4">Quản lý Tài khoản (User & Staff)</h2>

				<div th:if="${success}" class="alert alert-success" role="alert">
					<span th:text="${success}"></span>
				</div>
				<div th:if="${error}" class="alert alert-danger" role="alert">
					<span th:text="${error}"></span>
				</div>

				<div class="d-flex justify-content-between align-items-center mb-3">
					<form th:action="@{/admin/users}" method="get" class="d-flex">
						<input type="search" name="keyword" th:value="${keyword}"
							class="form-control me-2" placeholder="Tìm kiếm theo Email/Tên">
						<button type="submit" class="btn btn-info">Tìm kiếm</button>
					</form>
					<a th:href="@{/admin/users/new}" class="btn btn-primary">Thêm
						Tài khoản Mới</a>
				</div>

				<table class="table table-bordered table-striped">
					<thead class="table-dark">
						<tr>
							<th>ID</th>
							<th>Email</th>
							<th>Tên đầy đủ</th>
							<th>Role</th>
							<th>Trạng thái</th>
							<th>Thao tác</th>
						</tr>
					</thead>
					<tbody>
						<tr th:each="user : ${users}">
							<td th:text="${user.id}">1</td>
							<td th:text="${user.email}">user@example.com</td>
							<td th:text="${user.fullName}">User Name</td>
							<td><span class="badge"
								th:classappend="${user.role == 'admin' ? 'bg-danger' : user.role == 'staff' ? 'bg-warning text-dark' : 'bg-primary'}"
								th:text="${user.role}">customer</span></td>
							<td><span th:if="${user.isActive}" class="badge bg-success">Active</span>
								<span th:unless="${user.isActive}" class="badge bg-secondary">Inactive</span>
							</td>
							<td><a th:href="@{/admin/users/{id}/edit(id=${user.id})}"
								class="btn btn-sm btn-info">Sửa</a>
								<form th:action="@{/admin/users/{id}/toggle(id=${user.id})}"
									method="post" style="display: inline;"
									onsubmit="return confirm('Bạn có chắc chắn muốn thay đổi trạng thái của tài khoản này?');">
									<button type="submit" class="btn btn-sm"
										th:classappend="${user.isActive ? 'btn-secondary' : 'btn-success'}"
										th:text="${user.isActive ? 'Disable' : 'Enable'}">Disable</button>
								</form></td>
						</tr>
					</tbody>
				</table>
				<div th:if="${userPage.empty}" class="alert alert-info">Không
					có tài khoản nào được tìm thấy.</div>

			</div>
		</div>
	</div>

	<div th:replace="~{fragments/footer :: footer}"></div>
	<script th:src="@{/webjars/bootstrap/5.3.8/js/bootstrap.bundle.min.js}"></script>
</body>
</html>