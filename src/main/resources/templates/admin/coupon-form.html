<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="vi">
<head>
    <div th:replace="~{fragments/admin/header :: header-css}"></div>
    <title th:text="${isEdit ? 'Sửa mã giảm giá' : 'Tạo mã giảm giá'}"></title>
</head>
<body class="layout-fixed sidebar-expand-lg">
<div class="app-wrapper"> 

	<div th:replace="~{fragments/admin/header :: header}"></div>
	
	<div th:replace="~{admin/home :: sidebar}"></div>

	<main class="app-main">
		<div class="app-content-header">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-sm-6"><h3 class="mb-0" th:text="${isEdit ? 'Chỉnh sửa Mã Giảm giá' : 'Tạo Mã Giảm giá'}"></h3></div>
                    <div class="col-sm-6">
                        <ol class="breadcrumb float-sm-end">
                            <li class="breadcrumb-item"><a th:href="@{/admin/home}">Home</a></li>
                            <li class="breadcrumb-item"><a th:href="@{/admin/coupons}">Mã Giảm giá</a></li>
                            <li class="breadcrumb-item active" aria-current="page" th:text="${isEdit ? 'Chỉnh sửa' : 'Tạo mới'}"></li>
                        </ol>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="app-content">
            <div class="container-fluid">
				<div class="card card-primary">
					<div class="card-header">
						<h3 class="card-title" th:text="${isEdit ? 'Chỉnh sửa: ' + coupon.code : 'Tạo mã giảm giá mới'}"></h3>
					</div>
					
					<form th:action="@{/admin/coupons}" th:object="${coupon}"
						method="post">
						
						<div class="card-body">
							<div th:if="${error}" class="alert alert-danger" th:text="${error}"></div>
							
							<input type="hidden" th:field="*{id}" th:if="${isEdit}" />

							<div class="row">
								<div class="col-md-4 mb-3">
									<label class="form-label">Code</label> <input class="form-control"
										th:field="*{code}" required>
								</div>
								<div class="col-md-4 mb-3">
									<label class="form-label">Loại</label> <select class="form-select"
										th:field="*{type}" required>
										<option th:each="t : ${couponTypes}" th:value="${t}"
											th:text="${t}"></option>
									</select>
								</div>
								<div class="col-md-4 mb-3">
									<label class="form-label">Giá trị</label> <input type="number"
										step="0.01" min="0.01" class="form-control" th:field="*{value}"
										required>
								</div>
							</div>

							<div class="row">
								<div class="col-md-4 mb-3">
									<label class="form-label">Min Subtotal</label> <input type="number"
										step="0.01" min="0" class="form-control" th:field="*{minSubtotal}">
								</div>
								<div class="col-md-4 mb-3">
									<label class="form-label">Max Discount</label> <input type="number"
										step="0.01" min="0" class="form-control" th:field="*{maxDiscount}">
								</div>
								<div class="col-md-4 mb-3">
									<label class="form-label">Số lượng</label> <input type="number"
										min="0" class="form-control" th:field="*{quantity}" required>
								</div>
							</div>

							<div class="row">
								<div class="col-md-6 mb-3">
									<label class="form-label">Bắt đầu</label> <input
										type="datetime-local" th:field="*{startsAt}"
										th:value="${#temporals.format(coupon.startsAt, 'yyyy-MM-dd''T''HH:mm')}"
										class="form-control" id="startsAt" required>
								</div>
								<div class="col-md-6 mb-3">
									<label class="form-label">Kết thúc</label> <input
										type="datetime-local" th:field="*{endsAt}"
										th:value="${#temporals.format(coupon.endsAt, 'yyyy-MM-dd''T''HH:mm')}"
										class="form-control" id="endsAt" required>
								</div>
							</div>

							<div class="row">
								<div class="col-md-6 mb-3">
									<label class="form-label">Chi nhánh áp dụng</label> <select
										class="form-select" name="branchId">
										<option th:value="${null}" th:selected="${coupon.branch == null}">Toàn
											hệ thống</option>
										<option th:each="b : ${branches}" th:value="${b.id}"
											th:text="${b.code + ' - ' + b.name}"
											th:selected="${coupon.branch != null and coupon.branch.id == b.id}"></option>
									</select>
								</div>
								<div class="col-md-6 mb-3 form-check d-flex align-items-center pt-4">
									<input class="form-check-input me-2" type="checkbox"
										th:field="*{active}" id="isActive"> <label
										class="form-check-label" for="isActive">Kích hoạt</label>
								</div>
							</div>
						</div>
						
						<div class="card-footer">
							<button class="btn btn-primary" type="submit"
								th:text="${isEdit ? 'Cập nhật' : 'Tạo mới'}"></button>
							<a th:href="@{/admin/coupons}" class="btn btn-secondary">Huỷ</a>
						</div>
					</form>
				</div>
            </div>
        </div>
    </main>

	<div th:replace="~{fragments/admin/footer :: footer}"></div>
	
</div> <div th:replace="~{fragments/admin/footer :: footer-scripts}"></div>
<script th:replace="~{admin/home :: script-active-sidebar}"></script>

</body>
</html>