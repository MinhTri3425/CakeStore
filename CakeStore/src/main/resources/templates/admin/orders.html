<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
<meta charset="UTF-8">
<title>Quản lý Đơn hàng</title>
<link rel="stylesheet"
	th:href="@{/webjars/bootstrap/5.3.8/css/bootstrap.min.css}" />
<link rel="stylesheet" th:href="@{/css/style.css}" />
</head>
<body>
	<div th:replace="~{fragments/header :: header}"></div>

	<div class="container-fluid mt-4">
		<div class="row">
			<div th:replace="~{admin/home :: sidebar}"></div>
			<div class="col-md-9">
				<h2 class="mb-4">Quản lý Đơn hàng</h2>

				<div th:if="${success}" class="alert alert-success" role="alert">
					<span th:text="${success}"></span>
				</div>
				<div th:if="${error}" class="alert alert-danger" role="alert">
					<span th:text="${error}"></span>
				</div>
                
                <div class="d-flex justify-content-end mb-3">
                    <a th:href="@{/admin/orders/new}" class="btn btn-primary">Tạo Đơn hàng Mới</a>
                </div>

				<div class="mb-4">
					<ul class="nav nav-tabs">
						<li class="nav-item"><a class="nav-link"
							th:classappend="${currentStatus == null || currentStatus.isEmpty() ? 'active' : ''}"
							th:href="@{/admin/orders}">Tất cả</a></li>
						<li class="nav-item" th:each="status : ${allStatuses}"><a
							class="nav-link"
							th:classappend="${currentStatus == status.name() ? 'active' : ''}"
							th:href="@{/admin/orders(status=${status.name()})}"
							th:text="${status}">Status Name</a></li>
					</ul>
				</div>

				<table class="table table-bordered table-striped">
					<thead class="table-dark">
						<tr>
							<th>ID</th>
							<th>Khách hàng</th>
							<th>Tổng tiền</th>
							<th>Trạng thái</th>
							<th>P.thức TT</th>
							<th>Ngày tạo</th>
							<th>Thao tác</th>
						</tr>
					</thead>
					<tbody>
						<tr th:each="order : ${orderPage.content}">
							<td th:text="${order.id}">#1001</td>
							<td th:text="${order.user.fullName}">Nguyễn Văn A</td>
							<td
								th:text="${#numbers.formatDecimal(order.total, 0, 'POINT', 0, 'POINT')} + ' VND'">500.000
								VND</td>
							<td><span class="badge"
								th:classappend="${order.status.name() == 'DELIVERED' ? 'bg-success' : order.status.name() == 'CANCELED' ? 'bg-danger' : 'bg-warning'}"
								th:text="${order.status}">NEW</span></td>
							<td th:text="${order.paymentMethod}">COD</td>
							<td
								th:text="${#temporals.format(order.createdAt, 'dd-MM-yyyy HH:mm')}">25/10/2025</td>
							<td><a th:href="@{/admin/orders/{id}(id=${order.id})}"
								class="btn btn-sm btn-primary">Chi tiết</a></td>
						</tr>
					</tbody>
				</table>
				<div th:if="${orderPage.empty}" class="alert alert-info">Không
					có đơn hàng nào được tìm thấy.</div>
				
                <nav th:if="${orderPage.totalPages > 0}">
                    </nav>
                
			</div>
		</div>
	</div>

	<div th:replace="~{fragments/footer :: footer}"></div>
	<script th:src="@{/webjars/bootstrap/5.3.8/js/bootstrap.bundle.min.js}"></script>
</body>
</html>