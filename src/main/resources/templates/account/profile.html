<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      lang="vi"
      th:replace="~{fragments/user/header :: layout(~{::content})}">

<!-- N·ªôi dung page ƒë∆∞·ª£c inject v√†o layout(...) c·ªßa header -->
<div th:fragment="content" style="color:#e5e7eb;">

  <section class="section" style="max-width:900px;margin-inline:auto;">

    <!-- HEADER PAGE -->
    <header class="section-head" style="margin-bottom:1.5rem;">
      <h2 class="section-title" style="font-size:1.4rem;font-weight:700;color:#fff;">
        T√†i kho·∫£n c·ªßa t√¥i
      </h2>

      <p style="color:#94a3b8;font-size:.9rem;">
        <span th:text="'Tham gia t·ª´ ' + ${profile.memberSince}"></span>
      </p>

      <!-- flash messages -->
      <div th:if="${msg=='updated'}"
           style="color:#22c55e;font-size:.9rem;">
        ƒê√£ l∆∞u th√¥ng tin c√° nh√¢n ‚úî
      </div>

      <div th:if="${msg=='pw_ok'}"
           style="color:#22c55e;font-size:.9rem;">
        ƒê·ªïi m·∫≠t kh·∫©u th√†nh c√¥ng ‚úî
      </div>

      <div th:if="${err=='update_failed'}"
           style="color:#f87171;font-size:.9rem;">
        Kh√¥ng l∆∞u ƒë∆∞·ª£c th√¥ng tin üò¢
      </div>

      <div th:if="${err=='pw_mismatch'}"
           style="color:#f87171;font-size:.9rem;">
        M·∫≠t kh·∫©u m·ªõi nh·∫≠p l·∫°i kh√¥ng kh·ªõp
      </div>

      <div th:if="${err=='pw_incorrect_old'}"
           style="color:#f87171;font-size:.9rem;">
        M·∫≠t kh·∫©u c≈© kh√¥ng ƒë√∫ng
      </div>

      <div th:if="${err=='pw_failed'}"
           style="color:#f87171;font-size:.9rem;">
        ƒê·ªïi m·∫≠t kh·∫©u l·ªói nh·∫π ü•≤
      </div>
    </header>


    <!-- CARD: Th√¥ng tin c√° nh√¢n -->
    <div style="
        background:#111827;
        border:1px solid rgba(148,163,184,.25);
        border-radius:16px;
        padding:1.25rem;
        margin-bottom:1.5rem;
        box-shadow:0 20px 60px rgba(0,0,0,.7);
        max-width:650px;
      ">

      <h3 style="font-size:1rem;font-weight:600;color:#fff;margin-bottom:1rem;">
        Th√¥ng tin c√° nh√¢n
      </h3>

      <form method="post"
            th:action="@{/account/profile}"
            style="display:grid;gap:1rem;">

        <!-- Email (read only) -->
        <div>
          <label style="color:#94a3b8;font-size:.8rem;display:block;margin-bottom:.4rem;">
            Email ƒëƒÉng nh·∫≠p
          </label>
          <input style="
                    width:100%;
                    background:#0b1220;
                    border:1px solid rgba(148,163,184,.3);
                    border-radius:8px;
                    padding:.6rem .75rem;
                    color:#fff;
                 "
                 th:value="${profile.email}"
                 disabled />
        </div>

        <!-- H·ªç v√† t√™n -->
        <div>
          <label style="color:#94a3b8;font-size:.8rem;display:block;margin-bottom:.4rem;">
            H·ªç v√† t√™n
          </label>
          <input name="fullName"
                 style="
                    width:100%;
                    background:#0b1220;
                    border:1px solid rgba(148,163,184,.3);
                    border-radius:8px;
                    padding:.6rem .75rem;
                    color:#fff;
                 "
                 th:value="${profile.fullName}" />
        </div>

        <!-- S·ªë ƒëi·ªán tho·∫°i -->
        <div>
          <label style="color:#94a3b8;font-size:.8rem;display:block;margin-bottom:.4rem;">
            S·ªë ƒëi·ªán tho·∫°i
          </label>
          <input name="phone"
                 style="
                    width:100%;
                    background:#0b1220;
                    border:1px solid rgba(148,163,184,.3);
                    border-radius:8px;
                    padding:.6rem .75rem;
                    color:#fff;
                 "
                 th:value="${profile.phone}" />
        </div>

        <div style="display:flex;justify-content:flex-end;">
          <button type="submit"
                  style="
                    background:#22c55e;
                    border:0;
                    color:#000;
                    font-weight:600;
                    border-radius:8px;
                    padding:.6rem 1rem;
                    font-size:.9rem;
                    cursor:pointer;
                  ">
            L∆∞u thay ƒë·ªïi
          </button>
        </div>
      </form>
    </div>


    <!-- CARD: ƒê·ªãa ch·ªâ m·∫∑c ƒë·ªãnh (read-only) -->
    <div style="
        background:#111827;
        border:1px solid rgba(148,163,184,.25);
        border-radius:16px;
        padding:1.25rem;
        margin-bottom:1.5rem;
        box-shadow:0 20px 60px rgba(0,0,0,.7);
        max-width:650px;
      ">

      <div style="display:flex;justify-content:space-between;align-items:flex-start;gap:1rem;flex-wrap:wrap;">

        <div style="flex-grow:1;min-width:200px;">
          <h3 style="font-size:1rem;font-weight:600;color:#fff;margin-bottom:.75rem;">
            ƒê·ªãa ch·ªâ nh·∫≠n h√†ng m·∫∑c ƒë·ªãnh
          </h3>

          <div style="color:#94a3b8;font-size:.8rem;margin-bottom:.4rem;">
            Ng∆∞·ªùi nh·∫≠n
          </div>
          <div style="color:#fff;font-weight:600;font-size:.95rem;">
            <span th:text="${profile.addressFullName}">T√™n ng∆∞·ªùi nh·∫≠n</span>
            <span style="color:#94a3b8;font-size:.8rem;font-weight:400;">
              ‚Ä¢ <span th:text="${profile.addressPhone}">0123xxxxxx</span>
            </span>
          </div>

          <div style="color:#94a3b8;font-size:.8rem;margin-top:1rem;margin-bottom:.4rem;">
            ƒê·ªãa ch·ªâ
          </div>
          <div style="
              font-size:.9rem;
              color:#e5e7eb;
              line-height:1.4;
              white-space:pre-line;
            "
            th:text="${profile.addressDisplay}">
            123 ƒê∆∞·ªùng ABC, Ph∆∞·ªùng DEF, Qu·∫≠n GHI, TP.HCM
          </div>
        </div>

        <div style="text-align:right;">
          <a th:href="@{/account/address}"
             style="
                background:#1e293b;
                border:1px solid rgba(96,165,250,.5);
                color:#60a5fa;
                font-size:.8rem;
                font-weight:500;
                padding:.5rem .75rem;
                border-radius:8px;
                text-decoration:none;
                display:inline-block;
             ">
            Qu·∫£n l√Ω s·ªï ƒë·ªãa ch·ªâ ‚Üí
          </a>
        </div>

      </div>
    </div>


    <!-- CARD: ƒê·ªïi m·∫≠t kh·∫©u -->
    <div style="
        background:#111827;
        border:1px solid rgba(148,163,184,.25);
        border-radius:16px;
        padding:1.25rem;
        margin-bottom:1.5rem;
        box-shadow:0 20px 60px rgba(0,0,0,.7);
        max-width:650px;
      ">

      <h3 style="font-size:1rem;font-weight:600;color:#fff;margin-bottom:1rem;">
        ƒê·ªïi m·∫≠t kh·∫©u
      </h3>

      <form method="post"
            th:action="@{/account/password}"
            style="display:grid;gap:1rem;">

        <div>
          <label style="color:#94a3b8;font-size:.8rem;display:block;margin-bottom:.4rem;">
            M·∫≠t kh·∫©u hi·ªán t·∫°i
          </label>
          <input type="password" name="oldPassword"
                 style="
                    width:100%;
                    background:#0b1220;
                    border:1px solid rgba(148,163,184,.3);
                    border-radius:8px;
                    padding:.6rem .75rem;
                    color:#fff;
                 " />
        </div>

        <div>
          <label style="color:#94a3b8;font-size:.8rem;display:block;margin-bottom:.4rem;">
            M·∫≠t kh·∫©u m·ªõi
          </label>
          <input type="password" name="newPassword"
                 style="
                    width:100%;
                    background:#0b1220;
                    border:1px solid rgba(148,163,184,.3);
                    border-radius:8px;
                    padding:.6rem .75rem;
                    color:#fff;
                 " />
        </div>

        <div>
          <label style="color:#94a3b8;font-size:.8rem;display:block;margin-bottom:.4rem;">
            Nh·∫≠p l·∫°i m·∫≠t kh·∫©u m·ªõi
          </label>
          <input type="password" name="confirmPassword"
                 style="
                    width:100%;
                    background:#0b1220;
                    border:1px solid rgba(148,163,184,.3);
                    border-radius:8px;
                    padding:.6rem .75rem;
                    color:#fff;
                 " />
        </div>

        <div style="display:flex;justify-content:flex-end;">
          <button type="submit"
                  style="
                    background:#60a5fa;
                    border:0;
                    color:#0b1220;
                    font-weight:600;
                    border-radius:8px;
                    padding:.6rem 1rem;
                    font-size:.9rem;
                    cursor:pointer;
                  ">
            ƒê·ªïi m·∫≠t kh·∫©u
          </button>
        </div>
      </form>
    </div>


    <!-- CARD: Link nhanh -->
    <div style="
        background:#111827;
        border:1px solid rgba(148,163,184,.25);
        border-radius:16px;
        padding:1.25rem;
        box-shadow:0 20px 60px rgba(0,0,0,.7);
        max-width:650px;
      ">

      <h3 style="font-size:1rem;font-weight:600;color:#fff;margin-bottom:1rem;">
        Ho·∫°t ƒë·ªông
      </h3>

      <div style="display:grid;row-gap:.75rem;font-size:.9rem;">

        <a th:href="@{/orders}"
           style="color:#60a5fa;text-decoration:none;">
          Xem l·ªãch s·ª≠ ƒë∆°n h√†ng ‚Üí
        </a>

        <a th:href="@{/account/address}"
           style="color:#60a5fa;text-decoration:none;">
          Qu·∫£n l√Ω s·ªï ƒë·ªãa ch·ªâ ‚Üí
        </a>

        <form th:action="@{/perform_logout}" method="post" style="margin:0;">
          <button type="submit"
                  style="
                    background:transparent;
                    border:0;
                    color:#f87171;
                    text-decoration:none;
                    font-size:.9rem;
                    text-align:left;
                    padding:0;
                    cursor:pointer;
                  ">
            ƒêƒÉng xu·∫•t t√†i kho·∫£n
          </button>
        </form>

      </div>
    </div>

  </section>
</div>
</html>
